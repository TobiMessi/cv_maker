<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generator CV</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background-color: white;
      color: black;
    }
    body.dark-mode {
      background-color: #121212;
      color: #eee;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    body.dark-mode .container {
      background-color: #222;
      border-color: #444;
      box-shadow: 0 4px 8px rgba(255,255,255,0.1);
    }
    h1, h2 {
      text-align: center;
    }
    h1 {
      color: #007BFF;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }
    body.dark-mode .form-group label {
      color: #ccc;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
      background-color: white;
      color: black;
      resize: vertical;
    }
    body.dark-mode input[type="text"], body.dark-mode textarea {
      background-color: #333;
      border-color: #555;
      color: #eee;
    }
    #photo-preview {
      max-width: 150px;
      max-height: 150px;
      margin: 10px 0;
      object-fit: cover;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .cv-preview {
      margin-top: 30px;
      border-top: 2px solid #ddd;
      padding-top: 20px;
    }
    body.dark-mode .cv-preview {
      border-color: #555;
    }
    .cv-preview img {
      max-width: 150px;
      max-height: 150px;
      object-fit: cover;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    body.dark-mode .cv-preview img {
      border-color: #555;
    }
    .buttons {
      text-align: center;
      margin-top: 20px;
    }
    button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 5px;
      margin: 5px;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #0056b3;
    }
    #darkmode-toggle-container {
      text-align: center;
      margin-bottom: 20px;
    }
    #darkmode-toggle-container label {
      cursor: pointer;
      font-weight: bold;
      user-select: none;
    }
    #darkmode-toggle {
      margin-right: 8px;
      transform: scale(1.2);
      vertical-align: middle;
    }
    /* Podgląd tekstu CV z zachowaniem nowych linii */
    .cv-text {
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Generator CV</h1>
    <div id="darkmode-toggle-container">
      <label>
        <input type="checkbox" id="darkmode-toggle" />
        Tryb ciemny
      </label>
    </div>
    <form id="cv-form" onsubmit="return false;">
      <div class="form-group">
        <label for="full-name">Imię i nazwisko</label>
        <input type="text" id="full-name" placeholder="Wpisz swoje imię i nazwisko" />
      </div>
      <div class="form-group">
        <label for="job-title">Stanowisko</label>
        <input type="text" id="job-title" placeholder="Wpisz swoje stanowisko" />
      </div>
      <div class="form-group">
        <label for="photo">Dodaj zdjęcie</label>
        <input type="file" id="photo" accept="image/*" />
        <img id="photo-preview" alt="Podgląd zdjęcia" />
      </div>
      <div class="form-group">
        <label for="contact-info">Dane kontaktowe</label>
        <textarea id="contact-info" rows="3" placeholder="Wpisz swój email, telefon, itd."></textarea>
      </div>
      <div class="form-group">
        <label for="work-experience">Doświadczenie zawodowe</label>
        <textarea id="work-experience" rows="5" placeholder="Opisz swoje doświadczenie zawodowe"></textarea>
      </div>
      <div class="form-group">
        <label for="education">Szkoły, do których uczęszczałem</label>
        <textarea id="education" rows="5" placeholder="Opisz szkoły, do których uczęszczałeś"></textarea>
      </div>
      <div class="form-group">
        <label for="skills">Umiejętności</label>
        <textarea id="skills" rows="3" placeholder="Wpisz swoje umiejętności"></textarea>
      </div>
      <div class="buttons">
        <button type="button" id="generate-btn">Generuj CV</button>
        <button type="button" id="print-btn">Drukuj CV</button>
        <button type="button" id="download-btn">Pobierz PDF</button>
      </div>
    </form>
    <div class="cv-preview" id="cv-preview">
      <h2>Podgląd CV</h2>
      <div id="cv-content">
        <p>Wciśnij "Generuj CV", aby zobaczyć podgląd.</p>
      </div>
    </div>
  </div>

  <!-- html2pdf.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    // Obsługa zdjęcia
    const photoInput = document.getElementById('photo');
    const photoPreview = document.getElementById('photo-preview');

    photoInput.addEventListener('change', function () {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          photoPreview.src = e.target.result;
          localStorage.setItem('photoSrc', e.target.result);
        };
        reader.readAsDataURL(file);
      } else {
        photoPreview.src = '';
        localStorage.removeItem('photoSrc');
      }
    });

    // Ładowanie danych i ustawienia po załadowaniu strony
    window.addEventListener('DOMContentLoaded', () => {
      const fields = ['full-name', 'job-title', 'contact-info', 'work-experience', 'education', 'skills'];
      fields.forEach(id => {
        const el = document.getElementById(id);
        const saved = localStorage.getItem(id);
        if (saved) el.value = saved;

        el.addEventListener('input', () => {
          localStorage.setItem(id, el.value);
        });
      });

      // Wczytaj zdjęcie z localStorage
      const savedPhoto = localStorage.getItem('photoSrc');
      if (savedPhoto) {
        photoPreview.src = savedPhoto;
      }

      // Tryb ciemny
      const toggle = document.getElementById('darkmode-toggle');
      if (localStorage.getItem('darkMode') === 'enabled') {
        document.body.classList.add('dark-mode');
        toggle.checked = true;
      }
      toggle.addEventListener('change', () => {
        if (toggle.checked) {
          document.body.classList.add('dark-mode');
          localStorage.setItem('darkMode', 'enabled');
        } else {
          document.body.classList.remove('dark-mode');
          localStorage.setItem('darkMode', 'disabled');
        }
      });

      // Przycisk generowania CV
      document.getElementById('generate-btn').addEventListener('click', generateCV);
      document.getElementById('print-btn').addEventListener('click', printCV);
      document.getElementById('download-btn').addEventListener('click', downloadPDF);
    });

    // Generowanie podglądu CV
    function generateCV() {
      const fullName = document.getElementById('full-name').value;
      const jobTitle = document.getElementById('job-title').value;
      const contactInfo = document.getElementById('contact-info').value;
      const workExperience = document.getElementById('work-experience').value;
      const education = document.getElementById('education').value;
      const skills = document.getElementById('skills').value;
      const photoSrc = photoPreview.src ? `<img src="${photoPreview.src}" alt="Zdjęcie" style="max-width: 150px; max-height: 150px; object-fit: cover; border-radius: 8px;">` : '';

      const cvContent = `
        <div style="padding: 20px; font-family: Arial, sans-serif;">
          <div style="text-align: center; margin-bottom: 20px;">
            ${photoSrc}
            <h1 style="margin: 10px 0;">${fullName || ''}</h1>
            <h3 style="color: gray;">${jobTitle || ''}</h3>
          </div>
          <p><strong>Dane kontaktowe:</strong><br><span class="cv-text">${contactInfo || ''}</span></p>
          <p><strong>Doświadczenie zawodowe:</strong><br><span class="cv-text">${workExperience || ''}</span></p>
          <p><strong>Szkoły, do których uczęszczałem:</strong><br><span class="cv-text">${education || ''}</span></p>
          <p><strong>Umiejętności:</strong><br><span class="cv-text">${skills || ''}</span></p>
        </div>
      `;

      document.getElementById('cv-content').innerHTML = cvContent;
    }

    // Drukowanie CV
    function printCV() {
      const cvPreview = document.getElementById('cv-preview').innerHTML;
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <html>
          <head>
            <title>Drukuj CV</title>
            <style>
              body {
                font-family: Arial, sans-serif;
                margin: 40px;
                padding: 0;
                font-size: 14pt;
              }
              img {
                max-width: 150px;
                max-height: 150px;
                object-fit: cover;
                border-radius: 8px;
              }
              h1, h3 {
                text-align: center;
              }
              p {
                margin: 15px 0;
                line-height: 1.6;
                white-space: pre-wrap;
              }
            </style>
          </head>
          <body>
            ${cvPreview}
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();
    }

    // Pobieranie CV jako PDF
    function downloadPDF() {
      const element = document.getElementById('cv-preview');
      if (!element) {
        alert('Nie znaleziono podglądu CV!');
        return;
      }
      const opt = {
        margin: 0.5,
        filename: 'CV.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }
  </script>
</body>
</html>


